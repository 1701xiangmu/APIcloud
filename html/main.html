<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>Hello APP</title>
    <link rel="stylesheet" type="text/css" href="../css/api.css" />
	<style>
		#con{
			margin: 10px;
			font-size: 24px;
		}
		/*ul{
			margin-bottom: 10px;
		}
		ul li{
			margin: 5px 10px;
			padding: 5px;
			color: #000;
			word-wrap: break-word;
		}*/
    #sys-info{
      width: 100%;
      display: flex;
      background-color: #ccc;
    }
    #sys-info P{
      text-indent: 2em;
      font-size: 24px;
      color:red;
    }
	</style>
</head>
<body>
    <label id="con">Hello APP</label>
	<div id='sys-info'>
	  <p>你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？</p>
      <p>你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？</p>
        <p>你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？</p>
          <p>你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？你好吗？</p>
	</div>
</body>
<script type="text/javascript" src="../script/api.js"></script>
<script type="text/javascript">
     apiready = function(){
       var param = {};
    param.loadingImgae = 'widget://image/refresh.png'; //定义刷新小箭头的图片
    param.bgColor = '#ccc';                            //定义下拉刷新区域的背景
    param.textColor = '#fff';                          //定义下拉刷新提示文字的颜色
    param.textDown = '下拉试试...';                     //定义下拉刷新文字
    param.textUp = '松开试试...';                       //定义松开刷新文字
    param.showTime = true;                             //定义是否显示最后一次刷新时间
    api.setRefreshHeaderInfo(param, function(ret, err){
          toDoRequest();
    });
		// var ver = api.version;
		// var sType = api.systemType;
		// var sVer = api.systemVersion;
		// var id = api.deviceId;
		// var model = api.deviceModel;
		// var name = api.deviceName;
		// var cType = api.connectionType;
		// var winName = api.winName;
		// var winWidth = api.winWidth;
		// var winHeight = api.winHeight;
		// var frameName = api.frameName || '';
		// var frameWidth = api.frameWidth || '';
		// var frameHeight = api.frameHeight || '';
    //
		// var str = '<ul>';
		// str += '<li>引擎版本信息: ' + ver + '</li>';
		// str += '<li>系统类型: ' + sType + '</li>';
		// str += '<li>系统版本: ' + sVer + '</li>';
		// str += '<li>设备标识: ' + id + '</li>';
		// str += '<li>设备型号: ' + model + '</li>';
		// str += '<li>设备名称: ' + name + '</li>';
		// str += '<li>网络状态: ' + cType + '</li>';
		// str += '<li>主窗口名字: ' + winName + '</li>';
		// str += '<li>主窗口宽度: ' + winWidth + '</li>';
		// str += '<li>主窗口高度: ' + winHeight + '</li>';
		// str += '<li>子窗口名字: ' + frameName + '</li>';
		// str += '<li>子窗口宽度: ' + frameWidth + '</li>';
		// str += '<li>子窗口高度: ' + frameHeight + '</li>';
		// str += '</ul>';
    //
		// $api.byId('sys-info').innerHTML = str;
    api. addEventListener({name:'scrolltobottom'}, function(ret, err){
            //refresh event callback
            param.loadingImgae = 'widget://image/refresh.png'; //定义刷新小箭头的图片
            param.bgColor = '#ccc';                            //定义下拉刷新区域的背景
            param.textColor = '#fff';                          //定义下拉刷新提示文字的颜色
            param.textDown = '刷新new试试...';                     //定义下拉刷新文字
            param.textUp = '松开试试...';                       //定义松开刷新文字
            param.showTime = true;
            toDoRequest();
        });
    };


    function toDoRequest(){
      var con = $api.byId('con');
      var haha = con.text;
    api.ajax({
        url:'http://xxx.xxx.xxx',
        method:'post',
        header:{
          "X-APICloud-AppId":"Ahjj233311",
          "X-APICloud-AppKey":"85sdfs5212sfsfs.54544"
        },
        data: {
          values: {
              "name": haha//传得参
          },

        }
    }, function(ret, err){
        api.refreshHeaderLoadDone();        //复位下拉刷新
        //do your business
    });
}
</script>
</html>
